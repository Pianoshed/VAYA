<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spark Runner: Level Up</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div id="game-window">
    <div id="start-page" class="page">
        <!-- Navigation Header -->
        <nav class="main-nav">
            <a href="/" class="nav-link">üè† Home</a>
            <a href="/mental" class="nav-link">üß† Mental Health</a>
            <a href="/mood_tracker" class="nav-link">üìä Mood Tracker</a>
            <a href="/Resources" class="nav-link">üìö Resources</a>
            <a href="/sel_activities" class="nav-link">üéØ Activities</a>
        </nav>

        <!-- Game Title Section -->
        <div class="game-intro">
            <h1 class="title">üèÉ Spark Runner</h1>
            <p class="subtitle">Collect glimmers of hope on your journey through the city</p>
            
            <!-- Game Info Cards -->
            <div class="info-cards">
                <div class="info-card">
                    <div class="card-icon">üéÆ</div>
                    <div class="card-title">How to Play</div>
                    <div class="card-text">Jump to collect glimmers<br>Press SPACE or CLICK</div>
                </div>
                <div class="info-card">
                    <div class="card-icon">‚ö°</div>
                    <div class="card-title">Speed Up</div>
                    <div class="card-text">Game gets faster<br>as you collect more!</div>
                </div>
                <div class="info-card">
                    <div class="card-icon">ü¶ò</div>
                    <div class="card-title">Double Jump</div>
                    <div class="card-text">Press twice in air<br>to reach higher glimmers</div>
                </div>
            </div>

            <!-- Character Selection -->
            <div class="character-selection">
                <h2 style="margin-bottom: 20px; font-size: 28px;">Choose Your Runner</h2>
                <div style="display: flex; gap: 25px; flex-wrap: wrap; justify-content: center;">
                    <button class="btn btn-character" onclick="initGame('female')" style="background: linear-gradient(135deg, #ff75a0, #ff6b9d);">
                        üèÉ‚Äç‚ôÄÔ∏è Female Runner
                    </button>
                    <button class="btn btn-character" onclick="initGame('male')" style="background: linear-gradient(135deg, #4cc9f0, #3ab4d9);">
                        üèÉ‚Äç‚ôÇÔ∏è Male Runner
                    </button>
                </div>
            </div>

            <!-- Game Rules -->
            <div class="game-rules">
                <div class="rule-item">‚ú® Collect glimmers to increase your score</div>
                <div class="rule-item">‚ö†Ô∏è Game ends after 5 consecutive misses</div>
                <div class="rule-item">üéØ Reach target score to level up</div>
            </div>
        </div>
    </div>

    <div id="game-page" class="page" style="display: none;">
        <a href="#" class="home-link" onclick="returnHome(); return false;">‚Üê Home</a>
        <div class="background-layer bg-sky"></div>
        <div class="cloud cloud-1"></div>
        <div class="cloud cloud-2"></div>
        <div class="cloud cloud-3"></div>
        
        <div class="building building-1"></div>
        <div class="building building-2"></div>
        <div class="building building-3"></div>
        <div class="building building-4"></div>
        <div class="building building-5"></div>
        <div class="building building-6"></div>

        <div class="streetlight streetlight-1"></div>
        <div class="streetlight streetlight-2"></div>
        <div class="streetlight streetlight-3"></div>
        <div class="traffic-light traffic-light-1"></div>
        
        <div class="street"></div>
        <div class="sidewalk"></div>
        
        <div id="stats">
            <div class="stat-box" id="score-val">‚ú® 0</div>
            <div class="stat-box" id="target-val">üéØ 10</div>
            <div class="stat-box" id="miss-val">‚ùå 0/5</div>
        </div>

        <div class="indicators">
            <div class="indicator-box" id="speed-indicator">‚ö° 1.0x</div>
        </div>
        
        <div class="game-controls">
            <button class="btn btn-small" onclick="pauseGame()" id="pause-btn">‚è∏ Pause</button>
        </div>
        
        <div id="player"></div>
        <div class="instructions">üéÆ SPACE or CLICK ‚Ä¢ Double Jump!</div>
    </div>

    <div id="levelup-page" class="page" style="display: none;">
        <h1 style="color: #f0a500; font-size: 48px;">‚ú® Moment of Reflection ‚ú®</h1>
        <p id="quote-box" class="quote">"Small steps are still progress."</p>
        <div>
            <button class="btn" onclick="returnToGame()">Continue ‚Üí</button>
            <button class="btn" onclick="returnHome()">üè† Home</button>
        </div>
    </div>

    <div id="gameover-page" class="page" style="display: none;">
        <h1 style="color: #e94560; font-size: 52px;">üíî Game Over</h1>
        <p style="font-size: 24px;">You missed 5 glimmers in a row!</p>
        <p id="final-score" style="font-size: 32px; color: #f0a500;">Score: 0 ‚ú®</p>
        <div>
            <button class="btn" onclick="tryAgain()">üîÑ Try Again</button>
            <button class="btn" onclick="returnHome()">üè† Home</button>
        </div>
    </div>
</div>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { 
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    color: white; 
    font-family: 'Segoe UI', sans-serif; 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    min-height: 100vh; 
    overflow: hidden; 
}

#game-window { 
    position: relative; 
    width: 100%;
    max-width: 1000px; 
    height: 650px; 
    border-radius: 20px; 
    box-shadow: 0 0 60px rgba(0,0,0,0.7); 
    overflow: hidden;
    border: 3px solid rgba(255,255,255,0.15);
}

.page { 
    position: absolute; 
    width: 100%; 
    height: 100%; 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    justify-content: center; 
    overflow-y: auto;
}

#start-page { 
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    z-index: 100;
    justify-content: flex-start;
    padding: 0;
}

/* Navigation Styles */
.main-nav {
    width: 100%;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.6));
    backdrop-filter: blur(20px);
    padding: 20px 30px;
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    border-bottom: 2px solid rgba(76, 201, 240, 0.3);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
}

.nav-link {
    color: white;
    text-decoration: none;
    padding: 10px 20px;
    border-radius: 10px;
    font-weight: 600;
    font-size: 15px;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
}

.nav-link:hover {
    background: rgba(76, 201, 240, 0.3);
    border-color: rgba(76, 201, 240, 0.6);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(76, 201, 240, 0.4);
}

/* Game Intro Section */
.game-intro {
    width: 100%;
    padding: 40px 30px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 30px;
}

/* Info Cards */
.info-cards {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    justify-content: center;
    margin: 20px 0;
}

.info-card {
    background: linear-gradient(135deg, rgba(76, 201, 240, 0.15), rgba(240, 165, 0, 0.15));
    border: 2px solid rgba(76, 201, 240, 0.4);
    border-radius: 15px;
    padding: 20px;
    width: 180px;
    text-align: center;
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
}

.info-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(76, 201, 240, 0.3);
    border-color: rgba(76, 201, 240, 0.6);
}

.card-icon {
    font-size: 42px;
    margin-bottom: 10px;
}

.card-title {
    font-size: 18px;
    font-weight: bold;
    color: #4cc9f0;
    margin-bottom: 8px;
}

.card-text {
    font-size: 13px;
    opacity: 0.9;
    line-height: 1.5;
}

/* Character Selection */
.character-selection {
    text-align: center;
    padding: 20px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 15px;
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.1);
}

.btn-character {
    padding: 18px 40px !important;
    font-size: 18px !important;
    min-width: 200px;
}

/* Game Rules */
.game-rules {
    display: flex;
    flex-direction: column;
    gap: 12px;
    width: 100%;
    max-width: 600px;
    padding: 20px;
}

.rule-item {
    background: rgba(0, 0, 0, 0.4);
    padding: 12px 20px;
    border-radius: 10px;
    border-left: 4px solid #f0a500;
    font-size: 15px;
    backdrop-filter: blur(10px);
}

#game-page { z-index: 50; }
#levelup-page, #gameover-page { 
    background: linear-gradient(135deg, #1a1a2e, #16213e);
    z-index: 150; 
    text-align: center; 
}

.bg-sky {
    position: absolute;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #4A90E2 0%, #87CEEB 30%, #FFB347 65%, #FF6B9D 100%);
}

.cloud {
    position: absolute;
    background: rgba(255, 255, 255, 0.7);
    border-radius: 100px;
    opacity: 0.6;
}

.cloud-1 { width: 100px; height: 40px; top: 50px; animation: move-cloud 25s linear infinite; }
.cloud-2 { width: 80px; height: 35px; top: 100px; animation: move-cloud 30s linear infinite 5s; }
.cloud-3 { width: 120px; height: 45px; top: 80px; animation: move-cloud 35s linear infinite 10s; }

@keyframes move-cloud {
    from { left: -150px; }
    to { left: 1100px; }
}

.building {
    position: absolute;
    bottom: 150px;
    background: linear-gradient(to right, #34495e, #2c3e50);
    border-top: 3px solid #7f8c8d;
}

.building-1 { left: 0%; width: 15%; height: 200px; }
.building-2 { left: 18%; width: 12%; height: 150px; }
.building-3 { left: 33%; width: 18%; height: 280px; }
.building-4 { left: 54%; width: 14%; height: 180px; }
.building-5 { left: 71%; width: 16%; height: 240px; }
.building-6 { left: 90%; width: 15%; height: 160px; }

.streetlight {
    position: absolute;
    bottom: 150px;
    width: 4px;
    height: 100px;
    background: #555;
}

.streetlight::before {
    content: '';
    position: absolute;
    top: 0;
    left: -8px;
    width: 20px;
    height: 15px;
    background: #FFD700;
    border-radius: 50%;
    box-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
}

.streetlight-1 { left: 200px; }
.streetlight-2 { left: 450px; }
.streetlight-3 { left: 700px; }

.traffic-light {
    position: absolute;
    bottom: 180px;
    left: 350px;
    width: 15px;
    height: 40px;
    background: #333;
    border-radius: 5px;
}

.traffic-light::before {
    content: '';
    position: absolute;
    top: 5px;
    left: 3px;
    width: 9px;
    height: 9px;
    background: #44ff44;
    border-radius: 50%;
    box-shadow: 0 0 10px #44ff44;
    animation: traffic-blink 2s ease-in-out infinite;
}

@keyframes traffic-blink {
    0%, 40% { background: #ff4444; }
    50%, 90% { background: #44ff44; }
}

.street {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 150px;
    background: linear-gradient(180deg, #666 0%, #222 100%);
    border-top: 5px solid #FFD700;
}

.street::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 4px;
    background: repeating-linear-gradient(90deg, #FFF 0px, #FFF 40px, transparent 40px, transparent 80px);
}

.sidewalk {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 30px;
    background: #7f8c8d;
    border-top: 3px solid #bdc3c7;
}

#player { 
    position: absolute; 
    width: 60px; 
    height: 100px; 
    left: 150px; 
    z-index: 60;
    filter: drop-shadow(0 4px 12px rgba(0,0,0,0.6));
}

#player.jumping { transform: rotate(-10deg) scale(1.08); }

.glimmer { 
    position: absolute; 
    padding: 16px 28px; 
    background: linear-gradient(135deg, #FFD700 0%, #FF8C00 50%, #FF4500 100%);
    border: 3px solid #FFF; 
    border-radius: 35px; 
    color: #000; 
    font-weight: 900; 
    box-shadow: 0 0 40px rgba(255, 215, 0, 1), 0 0 80px rgba(255, 140, 0, 0.8);
    animation: glimmer-pulse 1.2s ease-in-out infinite;
    font-size: 17px;
    letter-spacing: 1px;
}

@keyframes glimmer-pulse {
    0%, 100% { transform: scale(1) rotate(-3deg); }
    50% { transform: scale(1.15) rotate(3deg); }
}

.glimmer::before, .glimmer::after {
    content: '‚ú®';
    position: absolute;
    top: 50%;
    font-size: 22px;
    animation: sparkle 1.5s ease-in-out infinite;
}

.glimmer::before { left: -20px; }
.glimmer::after { right: -20px; }

@keyframes sparkle {
    0%, 100% { opacity: 0.4; transform: translateY(-50%) scale(0.7); }
    50% { opacity: 1; transform: translateY(-50%) scale(1.3); }
}

#stats { 
    position: absolute; 
    top: 20px; 
    width: 100%; 
    display: flex; 
    justify-content: space-around; 
    font-size: 19px; 
    z-index: 100;
    padding: 0 20px;
}

.stat-box {
    background: rgba(0, 0, 0, 0.8);
    padding: 10px 24px;
    border-radius: 15px;
    border: 2px solid rgba(76, 201, 240, 0.6);
    backdrop-filter: blur(15px);
}

.stat-box.danger {
    border-color: #e94560;
    animation: pulse-danger 0.8s infinite;
}

@keyframes pulse-danger {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.08); }
}

.btn { 
    padding: 16px 34px; 
    margin: 10px; 
    border: none; 
    border-radius: 14px; 
    cursor: pointer; 
    font-weight: bold; 
    font-size: 16px;
    color: white; 
    background: linear-gradient(135deg, #4cc9f0, #3ab4d9);
}

.btn:hover { transform: translateY(-4px); }
.btn-small { padding: 10px 20px; font-size: 14px; }

.home-link {
    position: absolute;
    top: 20px;
    left: 20px;
    padding: 12px 24px;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    text-decoration: none;
    border-radius: 12px;
    border: 2px solid rgba(255,255,255,0.3);
    z-index: 200;
    font-size: 15px;
    font-weight: bold;
}

.game-controls {
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 100;
}

.indicators {
    position: absolute;
    top: 75px;
    left: 20px;
    z-index: 100;
}

.indicator-box {
    background: rgba(0, 0, 0, 0.8);
    padding: 10px 20px;
    border-radius: 12px;
    font-size: 15px;
    border: 2px solid rgba(240, 165, 0, 0.6);
}

.instructions {
    position: absolute;
    bottom: 25px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.85);
    padding: 12px 30px;
    border-radius: 12px;
    font-size: 14px;
    z-index: 100;
}

.title {
    font-size: 62px;
    background: linear-gradient(135deg, #4cc9f0, #f0a500);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-weight: 800;
}

.subtitle { opacity: 0.9; margin-bottom: 40px; font-size: 18px; }
.quote { font-style: italic; font-size: 26px; color: #4cc9f0; margin: 30px 0; }
</style>

<script>
const gameState = {
    score: 0, active: false, paused: false, playerY: 450, velocity: 0, glimmers: [],
    target: 10, isJumping: false, canDoubleJump: false, hasDoubleJumped: false,
    baseSpeed: 7, currentSpeed: 7, speedMultiplier: 1.0,
    consecutiveMisses: 0, maxMisses: 5, lastSpawnTime: 0, minSpawnInterval: 800,
    savedGender: 'male',
    words: ["Hope","Joy","Peace","Love","Dream","Smile","Light","Brave","Strong","Faith","Trust","Grace","Kind","Calm","Happy","Shine","Rise","Grow","Heal","Believe","Wonder","Magic","Soul","Heart","Spirit","Life","Free","Zen","Flow","Bliss"],
    quotes: ["You are doing better than you think.","This feeling is temporary. You are strong.","Progress is not always a straight line.","You deserve peace of mind.","You have survived 100% of your bad days."]
};

const femaleCharacter = `<svg viewBox="0 0 80 130"><circle cx="40" cy="20" r="12" fill="#f4c2a5"/><ellipse cx="48" cy="18" rx="8" ry="6" fill="#3d2817"/><circle cx="37" cy="19" r="1.5" fill="#000"/><circle cx="43" cy="19" r="1.5" fill="#000"/><ellipse cx="40" cy="50" rx="14" ry="22" fill="#ff75a0"/><rect x="26" y="38" width="28" height="16" fill="#ff75a0" rx="3"/><ellipse cx="28" cy="48" rx="5" ry="18" fill="#f4c2a5" transform="rotate(-35 28 48)"/><ellipse cx="52" cy="52" rx="5" ry="18" fill="#f4c2a5" transform="rotate(25 52 52)"/><ellipse cx="44" cy="88" rx="6" ry="28" fill="#ff6b9d" transform="rotate(-15 44 88)"/><ellipse cx="46" cy="112" rx="5" ry="12" fill="#f4c2a5" transform="rotate(-20 46 112)"/><ellipse cx="36" cy="82" rx="6" ry="24" fill="#ff6b9d" transform="rotate(25 36 82)"/><ellipse cx="48" cy="120" rx="8" ry="4" fill="#fff" transform="rotate(-15 48 120)"/></svg>`;

const maleCharacter = `<svg viewBox="0 0 80 130"><circle cx="40" cy="20" r="13" fill="#f1c27d"/><path d="M 28 18 Q 32 12 40 10 Q 48 12 52 18" fill="#3d2817"/><circle cx="36" cy="20" r="1.5" fill="#000"/><circle cx="44" cy="20" r="1.5" fill="#000"/><ellipse cx="40" cy="52" rx="16" ry="24" fill="#4cc9f0"/><rect x="24" y="38" width="32" height="18" fill="#4cc9f0" rx="4"/><ellipse cx="26" cy="50" rx="6" ry="20" fill="#f1c27d" transform="rotate(-40 26 50)"/><ellipse cx="54" cy="54" rx="6" ry="20" fill="#f1c27d" transform="rotate(30 54 54)"/><ellipse cx="45" cy="90" rx="7" ry="30" fill="#2c5f7f" transform="rotate(-12 45 90)"/><ellipse cx="48" cy="115" rx="6" ry="14" fill="#f1c27d" transform="rotate(-18 48 115)"/><ellipse cx="50" cy="124" rx="9" ry="5" fill="#2d3436" transform="rotate(-12 50 124)"/></svg>`;

function switchPage(pageId) {
    ['start-page','game-page','levelup-page','gameover-page'].forEach(id => {
        const p = document.getElementById(id);
        if (p) p.style.display = 'none';
    });
    const t = document.getElementById(pageId);
    if (t) t.style.display = 'flex';
}

function initGame(gender) {
    Object.assign(gameState, {score:0, active:true, paused:false, playerY:450, velocity:0, glimmers:[], isJumping:false, canDoubleJump:false, hasDoubleJumped:false, currentSpeed:gameState.baseSpeed, speedMultiplier:1.0, consecutiveMisses:0, lastSpawnTime:Date.now(), savedGender:gender});
    switchPage('game-page');
    document.getElementById('score-val').innerText = '‚ú® 0';
    document.getElementById('target-val').innerText = 'üéØ ' + gameState.target;
    document.getElementById('miss-val').innerText = '‚ùå 0/5';
    document.getElementById('miss-val').classList.remove('danger');
    document.getElementById('speed-indicator').innerText = '‚ö° 1.0x';
    document.getElementById('player').innerHTML = gender === 'female' ? femaleCharacter : maleCharacter;
    document.querySelectorAll('.glimmer').forEach(g => g.remove());
    gameLoop();
}

function tryAgain() { initGame(gameState.savedGender); }
function returnHome() { gameState.active = false; switchPage('start-page'); document.querySelectorAll('.glimmer').forEach(g => g.remove()); }
function pauseGame() {
    gameState.paused = !gameState.paused;
    document.getElementById('pause-btn').innerText = gameState.paused ? '‚ñ∂ Resume' : '‚è∏ Pause';
    if (!gameState.paused) gameLoop();
}

function returnToGame() { gameState.active = true; gameState.paused = false; switchPage('game-page'); gameLoop(); }
function jump(e) {
    if (e) e.preventDefault();
    if (!gameState.active || gameState.paused) return;
    if (!gameState.isJumping) {
        gameState.velocity = -15;
        gameState.isJumping = true;
        gameState.canDoubleJump = true;
        gameState.hasDoubleJumped = false;
    } else if (gameState.canDoubleJump && !gameState.hasDoubleJumped) {
        gameState.velocity = -14;
        gameState.hasDoubleJumped = true;
    }
}

function gameOver() { gameState.active = false; document.getElementById('final-score').innerText = `Score: ${gameState.score} ‚ú®`; switchPage('gameover-page'); }
function levelUp() { gameState.active = false; document.getElementById('quote-box').innerText = `"${gameState.quotes[Math.floor(Math.random()*gameState.quotes.length)]}"`; switchPage('levelup-page'); gameState.target += 10; gameState.consecutiveMisses = 0; }
function updateSpeed() {
    const si = Math.floor(gameState.score / 5) * 0.15;
    gameState.speedMultiplier = 1.0 + si;
    gameState.currentSpeed = gameState.baseSpeed * gameState.speedMultiplier;
    document.getElementById('speed-indicator').innerText = `‚ö° ${gameState.speedMultiplier.toFixed(1)}x`;
}

function updateMissCounter() {
    const m = document.getElementById('miss-val');
    m.innerText = `‚ùå ${gameState.consecutiveMisses}/5`;
    m.classList.toggle('danger', gameState.consecutiveMisses >= 3);
}

function gameLoop() {
    if (!gameState.active || gameState.paused) return;
    gameState.velocity += 0.6;
    gameState.playerY += gameState.velocity;
    if (gameState.playerY > 470) { gameState.playerY = 470; gameState.velocity = 0; gameState.isJumping = false; gameState.canDoubleJump = false; gameState.hasDoubleJumped = false; }
    if (gameState.playerY < 0) { gameState.playerY = 0; gameState.velocity = 0; }
    const p = document.getElementById('player');
    if (p) { p.style.top = gameState.playerY + 'px'; p.className = gameState.isJumping ? 'jumping' : ''; }
    
    const ct = Date.now();
    if (ct - gameState.lastSpawnTime > gameState.minSpawnInterval && Math.random() < 0.04) {
        const w = gameState.words[Math.floor(Math.random() * gameState.words.length)];
        const gid = 'g-' + ct + '-' + Math.random();
        const g = document.createElement('div');
        g.className = 'glimmer';
        g.id = gid;
        g.innerText = w;
        g.style.left = '1000px';
        const yp = [380,340,300,260,420,350,310,290,400,360][Math.floor(Math.random()*10)];
        g.style.top = yp + 'px';
        document.getElementById('game-page').appendChild(g);
        gameState.glimmers.push({id:gid, x:1000, y:yp, missed:false});
        gameState.lastSpawnTime = ct;
    }
    
    for (let i = gameState.glimmers.length - 1; i >= 0; i--) {
        const g = gameState.glimmers[i];
        g.x -= gameState.currentSpeed;
        const el = document.getElementById(g.id);
        if (el) {
            el.style.left = g.x + 'px';
            const py = gameState.playerY + 50;
            const gy = g.y + 15;
            if (g.x > 150 && g.x < 210 && Math.abs(py - gy) < 65) {
                gameState.score++;
                gameState.consecutiveMisses = 0;
                document.getElementById('score-val').innerText = '‚ú® ' + gameState.score;
                updateMissCounter();
                updateSpeed();
                el.style.transition = 'all 0.3s';
                el.style.transform = 'scale(1.8) rotate(360deg)';
                el.style.opacity = '0';
                setTimeout(() => { if (el.parentNode) el.remove(); }, 300);
                gameState.glimmers.splice(i, 1);
                if (gameState.score >= gameState.target) { levelUp(); return; }
            } else if (g.x < -100) {
                if (!g.missed) {
                    g.missed = true;
                    gameState.consecutiveMisses++;
                    updateMissCounter();
                    if (gameState.consecutiveMisses >= gameState.maxMisses) { gameOver(); return; }
                }
                el.remove();
                gameState.glimmers.splice(i, 1);
            }
        }
    }
    requestAnimationFrame(gameLoop);
}

document.addEventListener('keydown', e => { if (e.code === 'Space') { e.preventDefault(); jump(e); } });
document.addEventListener('click', e => { if (!e.target.closest('.btn') && !e.target.classList.contains('home-link') && gameState.active && !gameState.paused) jump(e); });
console.log('üèÉ Spark Runner Loaded! ‚ú®');
</script>
</body>
</html>